<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="common.css">
    <script src="util.js"></script>
    <script src="elimination_suffix.js"></script>
    <script src="explain_assertions.js"></script>
    <title>Explain Assertions</title>
</head>
<body>
<h2>Show the effect of assertions</h2>
<p>This graphically shows the implications of a set
    of assertions about an IRV (instant runoff) election
    which hopefully combine to conclude that there is only one
    possible winning candidate.</p>
<p>This is useful if you have been convinced (from auditing) that
   each of the individual assertions is true, and now want to
   see what that implies about the whole election. This page
   demonstrates the logic in a manner that is reasonable for a human
   (rather than a computer) to check.</p>

<h3>Input</h3>
<p>Input is a JSON file describing the assertions.  Or load from file <input type="file" id="InputFile">. Current formats
    accepted are:</p>
<ul>
    <li>The output of RAIRE, primarily by Michelle Blom (<a href="https://github.com/DemocracyDevelopers/SHANGRLA/blob/main/shangrla/Examples/Data/SF2019Nov8Assertions.json">example</a>) </li>
    <li>The output of raire-rs, a rewrite of the above primarily by Andrew Conway (<a href="example_output.json">example</a>)</li>
    <li>The log from Shangri-La, primarily by Phillip Stark. (<a href="https://github.com/DemocracyDevelopers/SHANGRLA/blob/main/shangrla/Examples/log.json">example with a typo (fixed below)</a>) </li>
</ul>



<textarea rows="22" cols="120" id="Input">
{
    "seed": 93686630803205229070, "replacement": false, "risk_function": "kaplan_martingale", "g": 0.1, "N_cards": 146662, "n_cvrs": 146662, "manifest_cards": 293555, "phantom_cards": 0, "error_rate": 0.002,
    "contests": {
        "339": {
            "risk_limit": 0.05,
            "choice_function": "IRV",
            "n_winners": 1,
            "candidates": ["15", "16", "17", "18", "45"],
            "reported_winners": ["15"],
            "assertion_file": "./Data/SF2019Nov8Assertions.json",
            "assertion_json": [{"winner": "18", "loser": "17", "already_eliminated": ["15", "16", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 18 17]"}, {"winner": "17", "loser": "16", "already_eliminated": ["15", "18", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 17 16]"}, {"winner": "15", "loser": "18", "already_eliminated": ["16", "17", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 18]"}, {"winner": "18", "loser": "16", "already_eliminated": ["15", "17", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 18 16]"}, {"winner": "17", "loser": "16", "already_eliminated": ["15", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 17 16 18]"}, {"winner": "15", "loser": "17", "already_eliminated": ["16", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 17 18]"}, {"winner": "15", "loser": "17", "already_eliminated": ["16", "18", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 17]"}, {"winner": "18", "loser": "16", "already_eliminated": ["15", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 18 16 17]"}, {"winner": "15", "loser": "16", "already_eliminated": ["17", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 16 18]"}, {"winner": "15", "loser": "16", "already_eliminated": ["17", "18", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 16]"}, {"winner": "15", "loser": "16", "already_eliminated": ["18", "45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 16 17]"}, {"winner": "15", "loser": "16", "already_eliminated": ["45"], "assertion_type": "IRV_ELIMINATION", "explanation": "Rules out outcomes with tail [... 15 16 17 18]"}, {"winner": "15", "loser": "45", "already_eliminated": "", "assertion_type": "WINNER_ONLY", "explanation": "Rules out case where 15 is eliminated before 45"}],
            "margins": {"18 v 17 elim 15 16 45": 0.045792366120740224, "17 v 16 elim 15 18 45": 0.019902906001554532, "15 v 18 elim 16 17 45": 0.028923647570604505, "18 v 16 elim 15 17 45": 0.0830003681935334, "17 v 16 elim 15 45": 0.058079120699294995, "15 v 17 elim 16 45": 0.08064120222007065, "15 v 17 elim 16 18 45": 0.10951712099930444, "18 v 16 elim 15 45": 0.14875018750596603, "15 v 16 elim 17 45": 0.13548158350492967, "15 v 16 elim 17 18 45": 0.1365247985163165, "15 v 16 elim 18 45": 0.16666893946625572, "15 v 16 elim 45": 0.15626406294745743, "15 v 45": 0.2956457705472446}
        }
    }
}
</textarea><br/>

<button onclick="explain_assertions()">Explain</button>

<div id="Format"> </div>


<h3>The assertions</h3>

<div id="Output"> </div>

<h3>Explanation of why it works</h3>
<input type="checkbox" id="ExpandAtStart"/><label for="ExpandAtStart">Expand fully all elimination orders at start</label><br/>
<input type="checkbox" id="DrawAsText"/><label for="ExpandAtStart">Draw as text rather than trees</label><br/>
<div id="Explanation"> </div>
</body>
</html>